<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fortress Mindset: UFW Interactive Notes</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        /* Custom styles for specific layout needs not covered by default Tailwind utilities */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f3f4f6; /* Warm neutral light gray */
            color: #1f2937;
        }

        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 400px;
        }

        @media (min-width: 768px) {
            .chart-container {
                height: 350px;
            }
        }
        
        .card-hover {
            transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
        }
        
        .card-hover:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }

        /* Custom scrollbar for log window */
        .log-window::-webkit-scrollbar {
            width: 8px;
        }
        .log-window::-webkit-scrollbar-track {
            background: #f1f1f1;
        }
        .log-window::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 4px;
        }
        .log-window::-webkit-scrollbar-thumb:hover {
            background: #555;
        }
    </style>
    <!-- Chosen Palette: Warm Neutrals (Slate/Gray) with Safe Green and Alert Red accents -->
    <!-- Application Structure Plan: 
         1. Hero Section: Introduction to the "Fortress Mindset" philosophy.
         2. The Firewall Simulator: A gamified dashboard where users "apply" the rules learned in the lesson. This reinforces the command logic and the "why".
         3. Service Grid: Cards detailing the specific ports/services added, reinforcing the port numbers.
         4. Protocol Analysis (The Research Question): A dedicated section answering "Why UDP?" using a comparative Radar chart to visualize the trade-offs (Speed vs. Reliability).
    -->
    <!-- Visualization & Content Choices:
         1. Doughnut Chart (Simulator): Visualizes "Security Posture" (Open vs. Secured Ports). Interaction: Buttons update the chart data. Justification: Immediate visual feedback on the impact of UFW rules. Library: Chart.js.
         2. Radar Chart (Protocol Analysis): Compares TCP vs UDP attributes (Speed, Reliability, Overhead). Interaction: Buttons to switch context (DHCP needs vs NTP needs). Justification: Clearly shows why one protocol outperforms the other for specific tasks. Library: Chart.js.
         3. Interactive Logs: Text area updates with "terminal commands" as users interact, reinforcing the CLI aspect.
    -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
</head>
<body class="bg-slate-50 text-slate-800">

    <!-- Navigation / Header -->
    <header class="bg-white shadow-sm sticky top-0 z-50">
        <div class="container mx-auto px-4 py-4 flex justify-between items-center">
            <div class="flex items-center space-x-2">
                <span class="text-2xl">üè∞</span>
                <h1 class="text-xl font-bold tracking-tight text-slate-800">Fortress Mindset <span class="text-slate-500 font-normal">| UFW Notes</span></h1>
            </div>
            <nav class="hidden md:flex space-x-6 text-sm font-medium text-slate-600">
                <a href="#philosophy" class="hover:text-indigo-600 transition">Philosophy</a>
                <a href="#simulator" class="hover:text-indigo-600 transition">Simulator</a>
                <a href="#protocols" class="hover:text-indigo-600 transition">Why UDP?</a>
            </nav>
        </div>
    </header>

    <main class="container mx-auto px-4 py-8 space-y-12">

        <!-- Intro Section -->
        <section id="philosophy" class="max-w-4xl mx-auto text-center space-y-4">
            <h2 class="text-3xl md:text-4xl font-extrabold text-slate-900">Building the Digital Fortress</h2>
            <p class="text-lg text-slate-600 max-w-2xl mx-auto leading-relaxed">
                Today's learning focused on the <strong>Uncomplicated Firewall (UFW)</strong>. 
                The goal is to make the machine invisible by default and only open specific gates for necessary traffic.
            </p>
            
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mt-8 text-left">
                <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-200 card-hover group cursor-pointer" onclick="toggleHighlight('concept-default')">
                    <div class="flex items-center justify-between mb-2">
                        <h3 class="font-bold text-slate-800">Default Security</h3>
                        <span class="text-xl group-hover:scale-110 transition">üõ°Ô∏è</span>
                    </div>
                    <p class="text-slate-600 text-sm">Deny all incoming, allow all outgoing.</p>
                    <div id="concept-default" class="hidden mt-3 text-xs bg-slate-100 p-2 rounded text-slate-700">
                        <code>sudo ufw default deny incoming</code><br>
                        Makes your server unresponsive to unsolicited pings.
                    </div>
                </div>

                <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-200 card-hover group cursor-pointer" onclick="toggleHighlight('concept-secure')">
                    <div class="flex items-center justify-between mb-2">
                        <h3 class="font-bold text-slate-800">Secure Access</h3>
                        <span class="text-xl group-hover:scale-110 transition">üîë</span>
                    </div>
                    <p class="text-slate-600 text-sm">Rate limiting SSH on port 2222.</p>
                    <div id="concept-secure" class="hidden mt-3 text-xs bg-slate-100 p-2 rounded text-slate-700">
                        <code>sudo ufw limit 2222/tcp</code><br>
                        Blocks IP addresses that attempt too many connections in 30 seconds.
                    </div>
                </div>

                <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-200 card-hover group cursor-pointer" onclick="toggleHighlight('concept-smart')">
                    <div class="flex items-center justify-between mb-2">
                        <h3 class="font-bold text-slate-800">Smart Firewall</h3>
                        <span class="text-xl group-hover:scale-110 transition">üß†</span>
                    </div>
                    <p class="text-slate-600 text-sm">Stateful packet inspection.</p>
                    <div id="concept-smart" class="hidden mt-3 text-xs bg-slate-100 p-2 rounded text-slate-700">
                        Allows return traffic automatically. If you ask for a website, the firewall lets the answer back in.
                    </div>
                </div>
            </div>
        </section>

        <!-- Interactive Simulator Section -->
        <section id="simulator" class="bg-white rounded-2xl shadow-lg border border-slate-200 overflow-hidden">
            <div class="bg-slate-900 px-6 py-4 border-b border-slate-800 flex justify-between items-center">
                <h3 class="text-white font-bold flex items-center gap-2">
                    <span class="inline-block w-3 h-3 rounded-full bg-green-500 animate-pulse"></span>
                    UFW Configuration Lab
                </h3>
                <span class="text-slate-400 text-sm">Interactive Mode</span>
            </div>
            
            <div class="p-6 md:p-8">
                <p class="text-slate-600 mb-6">
                    <strong>Challenge:</strong> Configure the firewall according to today's lesson. Observe how the "Security Posture" chart changes as you apply the correct rules.
                </p>

                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 items-start">
                    
                    <!-- Controls & Log -->
                    <div class="space-y-6">
                        <div class="grid grid-cols-1 sm:grid-cols-2 gap-3">
                            <button id="btn-reset" onclick="simReset()" class="col-span-1 sm:col-span-2 py-2 px-4 bg-red-100 hover:bg-red-200 text-red-700 font-semibold rounded-lg transition text-sm">Reset Firewall</button>
                            
                            <button id="btn-deny" onclick="simApply('deny')" class="py-3 px-4 bg-slate-100 hover:bg-slate-200 text-slate-700 font-medium rounded-lg transition border border-slate-300 text-left flex justify-between items-center group">
                                <span>1. Default Deny</span>
                                <span class="opacity-0 group-hover:opacity-100">üõ°Ô∏è</span>
                            </button>
                            
                            <button id="btn-ssh" onclick="simApply('ssh')" class="py-3 px-4 bg-slate-100 hover:bg-slate-200 text-slate-700 font-medium rounded-lg transition border border-slate-300 text-left flex justify-between items-center group">
                                <span>2. Limit SSH (2222)</span>
                                <span class="opacity-0 group-hover:opacity-100">üîë</span>
                            </button>
                            
                            <button id="btn-services" onclick="simApply('services')" class="col-span-1 sm:col-span-2 py-3 px-4 bg-slate-100 hover:bg-slate-200 text-slate-700 font-medium rounded-lg transition border border-slate-300 text-left flex justify-between items-center group">
                                <span>3. Open Services (DHCP/TFTP/NTP)</span>
                                <span class="opacity-0 group-hover:opacity-100">üîå</span>
                            </button>
                        </div>

                        <!-- Terminal Log -->
                        <div class="bg-slate-900 rounded-lg p-4 font-mono text-sm h-48 overflow-y-auto log-window shadow-inner">
                            <div id="sim-log" class="text-green-400 space-y-1">
                                <span class="opacity-50">root@server:~# Waiting for input...</span>
                            </div>
                        </div>
                    </div>

                    <!-- Visualization -->
                    <div class="flex flex-col items-center justify-center bg-slate-50 rounded-xl p-4 border border-slate-100">
                        <h4 class="text-sm font-semibold text-slate-500 mb-4 uppercase tracking-wider">Network Exposure Analysis</h4>
                        <div class="chart-container">
                            <canvas id="firewallChart"></canvas>
                        </div>
                        <div id="status-message" class="mt-4 text-center font-medium text-red-500">
                            Current Status: Insecure (All Ports Open)
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- New Services Detail Grid -->
        <section id="services">
            <h2 class="text-2xl font-bold text-slate-900 mb-2">New Services & Protocols</h2>
            <p class="text-slate-600 mb-6">You configured UFW to allow traffic for these specific critical infrastructure services.</p>
            
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                <!-- DHCP -->
                <div class="bg-white p-5 rounded-lg border border-slate-200 shadow-sm flex flex-col items-center text-center">
                    <div class="w-12 h-12 bg-blue-100 text-blue-600 rounded-full flex items-center justify-center text-2xl mb-3">üîå</div>
                    <h3 class="font-bold text-lg">DHCP Server</h3>
                    <div class="mt-2 space-y-1">
                        <span class="inline-block px-2 py-1 bg-slate-100 text-xs font-mono rounded">Port 67</span>
                        <span class="inline-block px-2 py-1 bg-blue-50 text-blue-700 text-xs font-bold rounded">UDP</span>
                    </div>
                    <p class="text-sm text-slate-500 mt-3">Assigns IP addresses to new devices on the network.</p>
                </div>

                <!-- TFTP -->
                <div class="bg-white p-5 rounded-lg border border-slate-200 shadow-sm flex flex-col items-center text-center">
                    <div class="w-12 h-12 bg-orange-100 text-orange-600 rounded-full flex items-center justify-center text-2xl mb-3">üì•</div>
                    <h3 class="font-bold text-lg">TFTP Server</h3>
                    <div class="mt-2 space-y-1">
                        <span class="inline-block px-2 py-1 bg-slate-100 text-xs font-mono rounded">Port 69</span>
                        <span class="inline-block px-2 py-1 bg-orange-50 text-orange-700 text-xs font-bold rounded">UDP</span>
                    </div>
                    <p class="text-sm text-slate-500 mt-3">Delivers boot files (PXE) to clients efficiently.</p>
                </div>

                <!-- NTP -->
                <div class="bg-white p-5 rounded-lg border border-slate-200 shadow-sm flex flex-col items-center text-center">
                    <div class="w-12 h-12 bg-purple-100 text-purple-600 rounded-full flex items-center justify-center text-2xl mb-3">‚è±Ô∏è</div>
                    <h3 class="font-bold text-lg">NTP Server</h3>
                    <div class="mt-2 space-y-1">
                        <span class="inline-block px-2 py-1 bg-slate-100 text-xs font-mono rounded">Port 123</span>
                        <span class="inline-block px-2 py-1 bg-purple-50 text-purple-700 text-xs font-bold rounded">UDP</span>
                    </div>
                    <p class="text-sm text-slate-500 mt-3">Synchronizes time clocks across the network.</p>
                </div>

                <!-- SFTP -->
                <div class="bg-white p-5 rounded-lg border border-slate-200 shadow-sm flex flex-col items-center text-center bg-gray-50 opacity-75">
                    <div class="w-12 h-12 bg-gray-200 text-gray-600 rounded-full flex items-center justify-center text-2xl mb-3">üîë</div>
                    <h3 class="font-bold text-lg">SFTP Server</h3>
                    <div class="mt-2 space-y-1">
                        <span class="inline-block px-2 py-1 bg-slate-100 text-xs font-mono rounded">Port 2222</span>
                        <span class="inline-block px-2 py-1 bg-green-50 text-green-700 text-xs font-bold rounded">TCP</span>
                    </div>
                    <p class="text-sm text-slate-500 mt-3">Piggybacks on SSH. No new rule needed if SSH is allowed.</p>
                </div>
            </div>
        </section>

        <!-- Research Question: UDP vs TCP -->
        <section id="protocols" class="bg-indigo-50 rounded-2xl p-6 md:p-8 border border-indigo-100">
            <div class="mb-8">
                <h2 class="text-2xl font-bold text-indigo-900 mb-2">Research Question: Why UDP? ü§î</h2>
                <p class="text-indigo-800">
                    DHCP, TFTP, and NTP all use UDP. Why choose a "connectionless" and "unreliable" protocol for such critical tasks?
                </p>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 items-center">
                <!-- Interactive Text Content -->
                <div class="space-y-4">
                    <div class="bg-white p-4 rounded-lg shadow-sm cursor-pointer hover:bg-indigo-50 transition border border-indigo-100" onclick="updateRadar('Speed')">
                        <h4 class="font-bold text-indigo-900">1. Speed & Startup</h4>
                        <p class="text-sm text-slate-600">TCP requires a 3-way handshake (SYN, SYN-ACK, ACK) before data flows. DHCP and TFTP happen at boot time; devices want an IP and boot file <em>immediately</em> without connection overhead.</p>
                    </div>
                    <div class="bg-white p-4 rounded-lg shadow-sm cursor-pointer hover:bg-indigo-50 transition border border-indigo-100" onclick="updateRadar('Overhead')">
                        <h4 class="font-bold text-indigo-900">2. Low Overhead</h4>
                        <p class="text-sm text-slate-600">UDP headers are tiny (8 bytes) compared to TCP (20+ bytes). For NTP, which sends tiny timestamps, TCP's overhead is massive waste.</p>
                    </div>
                    <div class="bg-white p-4 rounded-lg shadow-sm cursor-pointer hover:bg-indigo-50 transition border border-indigo-100" onclick="updateRadar('Broadcast')">
                        <h4 class="font-bold text-indigo-900">3. Broadcasting</h4>
                        <p class="text-sm text-slate-600">DHCP relies on shouting "I need an IP!" to the whole network. TCP is strictly one-to-one. UDP supports broadcasting, essential for discovery.</p>
                    </div>
                </div>

                <!-- Radar Chart Container -->
                <div class="bg-white p-4 rounded-xl shadow-md border border-indigo-100">
                    <h4 class="text-center font-bold text-slate-700 mb-2">Protocol Characteristics</h4>
                    <div class="chart-container">
                        <canvas id="protocolChart"></canvas>
                    </div>
                    <p class="text-center text-xs text-slate-400 mt-2">Compare TCP vs UDP attributes</p>
                </div>
            </div>
        </section>
        
        <footer class="text-center text-slate-400 text-sm py-8 border-t border-slate-200">
            <p>Fortress Mindset Learning Notes ‚Ä¢ Generated from Source Report</p>
        </footer>

    </main>

    <script>
        // --- State Management ---
        const state = {
            simStep: 0, // 0: Init, 1: Deny, 2: SSH, 3: Services
            currentRadarFocus: 'General'
        };

        // --- Chart Objects ---
        let firewallChartInstance = null;
        let protocolChartInstance = null;

        // --- Initialization ---
        document.addEventListener('DOMContentLoaded', () => {
            initFirewallChart();
            initProtocolChart();
        });

        // --- Helper: Toggle Highlights in Philosophy Section ---
        function toggleHighlight(id) {
            const el = document.getElementById(id);
            if (el.classList.contains('hidden')) {
                el.classList.remove('hidden');
                el.classList.add('block');
            } else {
                el.classList.add('hidden');
                el.classList.remove('block');
            }
        }

        // --- Firewall Simulator Logic ---
        
        function initFirewallChart() {
            const ctx = document.getElementById('firewallChart').getContext('2d');
            firewallChartInstance = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Unsecured Ports', 'Secured/Blocked Ports', 'Allowed Services'],
                    datasets: [{
                        data: [100, 0, 0], // Initial state: All open/insecure
                        backgroundColor: [
                            '#F87171', // Red (Insecure)
                            '#94A3B8', // Gray (Blocked/Hidden)
                            '#4ADE80'  // Green (Allowed Services)
                        ],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { position: 'bottom' },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return context.label + ': ' + context.raw + '%';
                                }
                            }
                        }
                    },
                    cutout: '70%'
                }
            });
        }

        function updateLog(message) {
            const log = document.getElementById('sim-log');
            const entry = document.createElement('div');
            entry.innerHTML = `<span class="text-green-500">‚ûú</span> <span class="text-white">${message}</span>`;
            log.appendChild(entry);
            log.scrollTop = log.scrollHeight;
        }

        function simReset() {
            state.simStep = 0;
            updateLog('Resetting firewall rules...');
            updateLog('ufw disable');
            updateLog('ufw reset');
            
            firewallChartInstance.data.datasets[0].data = [100, 0, 0];
            firewallChartInstance.update();
            
            document.getElementById('status-message').innerText = "Current Status: Insecure (All Ports Open)";
            document.getElementById('status-message').className = "mt-4 text-center font-medium text-red-500";
            
            // Reset button states
            ['btn-deny', 'btn-ssh', 'btn-services'].forEach(id => {
                document.getElementById(id).classList.remove('bg-green-100', 'border-green-300');
                document.getElementById(id).classList.add('bg-slate-100');
            });
        }

        function simApply(step) {
            if (step === 'deny') {
                state.simStep = 1;
                updateLog('ufw default deny incoming');
                updateLog('Default policy changed to DROP.');
                
                // 95% blocked, 5% explicitly allowed (none yet really, but for visual)
                firewallChartInstance.data.datasets[0].data = [5, 95, 0];
                firewallChartInstance.update();
                
                document.getElementById('status-message').innerText = "Status: Stealth Mode (Invisible)";
                document.getElementById('status-message').className = "mt-4 text-center font-medium text-slate-500";
                
                document.getElementById('btn-deny').classList.add('bg-green-100', 'border-green-300');
            }
            else if (step === 'ssh') {
                if (state.simStep < 1) { updateLog('Error: Set default deny first!'); return; }
                state.simStep = 2;
                updateLog('ufw limit 2222/tcp');
                updateLog('Rule added: Limit SSH on port 2222');
                
                // 0 insecure, 90 blocked, 10 allowed (SSH)
                firewallChartInstance.data.datasets[0].data = [0, 90, 10];
                firewallChartInstance.update();
                
                document.getElementById('status-message').innerText = "Status: Admin Access Secured";
                document.getElementById('status-message').className = "mt-4 text-center font-medium text-blue-500";
                
                document.getElementById('btn-ssh').classList.add('bg-green-100', 'border-green-300');
            }
            else if (step === 'services') {
                if (state.simStep < 2) { updateLog('Error: Secure SSH first!'); return; }
                state.simStep = 3;
                updateLog('ufw allow 67/udp comment "DHCP"');
                updateLog('ufw allow 69/udp comment "TFTP"');
                updateLog('ufw allow 123/udp comment "NTP"');
                
                // 0 insecure, 70 blocked, 30 allowed (SSH + Services)
                firewallChartInstance.data.datasets[0].data = [0, 70, 30];
                firewallChartInstance.update();
                
                document.getElementById('status-message').innerText = "Status: Fortress Active (Services Operational)";
                document.getElementById('status-message').className = "mt-4 text-center font-medium text-green-600";
                
                document.getElementById('btn-services').classList.add('bg-green-100', 'border-green-300');
            }
        }

        // --- Protocol Radar Chart Logic ---

        function initProtocolChart() {
            const ctx = document.getElementById('protocolChart').getContext('2d');
            protocolChartInstance = new Chart(ctx, {
                type: 'radar',
                data: {
                    labels: ['Reliability', 'Speed/Low Latency', 'Header Efficiency', 'Broadcast Support', 'Order Guarantee'],
                    datasets: [
                        {
                            label: 'TCP (SSH/SFTP)',
                            data: [10, 4, 3, 0, 10], // High reliability/order, low speed/efficiency
                            fill: true,
                            backgroundColor: 'rgba(59, 130, 246, 0.2)',
                            borderColor: 'rgb(59, 130, 246)',
                            pointBackgroundColor: 'rgb(59, 130, 246)',
                        },
                        {
                            label: 'UDP (DHCP/TFTP/NTP)',
                            data: [4, 10, 10, 10, 2], // High speed/efficiency/broadcast, low reliability
                            fill: true,
                            backgroundColor: 'rgba(249, 115, 22, 0.2)',
                            borderColor: 'rgb(249, 115, 22)',
                            pointBackgroundColor: 'rgb(249, 115, 22)',
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        r: {
                            angleLines: { display: true },
                            suggestedMin: 0,
                            suggestedMax: 10
                        }
                    }
                }
            });
        }

        function updateRadar(focus) {
            // This function could highlight specific data points or change text descriptions
            // For now, it visually highlights the chart canvas to draw attention
            const canvas = document.getElementById('protocolChart');
            canvas.classList.add('scale-105', 'transition-transform', 'duration-200');
            setTimeout(() => canvas.classList.remove('scale-105'), 200);
        }

    </script>
</body>
</html>